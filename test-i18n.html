<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>i18n Test</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 40px;
            background: #1a1a2e;
            color: #eee;
        }
        .test-section {
            background: #16213e;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
            border: 1px solid #00d4ff;
        }
        .lang-switcher {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 10px 15px;
            background: rgba(0,212,255,0.1);
            border: 1px solid rgba(0,212,255,0.3);
            border-radius: 8px;
            width: fit-content;
        }
        select {
            background: #16213e;
            color: #eee;
            border: 1px solid #00d4ff;
            padding: 5px 10px;
            border-radius: 4px;
            font-size: 14px;
        }
        .status {
            padding: 10px;
            margin: 10px 0;
            border-radius: 4px;
            font-family: monospace;
        }
        .success { background: rgba(0,255,0,0.1); border-left: 4px solid #0f0; }
        .error { background: rgba(255,0,0,0.1); border-left: 4px solid #f00; }
        .info { background: rgba(0,212,255,0.1); border-left: 4px solid #00d4ff; }
    </style>
</head>
<body>
    <h1>üîß i18n System Diagnostics</h1>

    <div class="test-section">
        <h2>Language Switcher</h2>
        <div class="lang-switcher">
            <label>üåê</label>
            <select id="lang-select"></select>
        </div>
    </div>

    <div class="test-section">
        <h2>Test Elements</h2>
        <p data-i18n="nav.exchange">–ë–æ—Ç-–æ–±–º–µ–Ω–Ω–∏–∫</p>
        <p data-i18n="nav.mev">–ú–≠–í-–±–æ—Ç</p>
        <p data-i18n="nav.arbitrage">–ê—Ä–±–∏—Ç—Ä–∞–∂</p>
        <p data-i18n="hero.title">–ü–æ–∫–∞ –≤—Å–µ –±–æ–ª—Ç–∞—é—Ç, –º—ã —Ä–∞–±–æ—Ç–∞–µ–º</p>
        <p data-i18n="header.login_btn">–í–æ–π—Ç–∏</p>
    </div>

    <div class="test-section">
        <h2>System Status</h2>
        <div id="status-container"></div>
    </div>

    <script src="i18n.js"></script>
    <script>
        const statusContainer = document.getElementById('status-container');

        function addStatus(message, type = 'info') {
            const div = document.createElement('div');
            div.className = `status ${type}`;
            div.textContent = message;
            statusContainer.appendChild(div);
        }

        async function initTest() {
            // Check if I18N loaded
            if (window.I18N) {
                addStatus('‚úÖ i18n.js loaded successfully', 'success');
                addStatus(`Available locales: ${window.I18N.AVAILABLE_LOCALES.join(', ')}`, 'info');
                addStatus(`Default locale: ${window.I18N.DEFAULT_LOCALE}`, 'info');
            } else {
                addStatus('‚ùå i18n.js not loaded!', 'error');
                return;
            }

            // Populate language selector
            const select = document.getElementById('lang-select');
            window.I18N.AVAILABLE_LOCALES.forEach(lang => {
                const option = document.createElement('option');
                option.value = lang;
                option.textContent = lang.toUpperCase();
                select.appendChild(option);
            });

            // Check localStorage
            const storedLang = localStorage.getItem('i18n:lang');
            if (storedLang) {
                addStatus(`Stored language: ${storedLang}`, 'info');
                select.value = storedLang;
            } else {
                addStatus('No stored language, using default', 'info');
            }

            // Initialize i18n
            try {
                await window.I18N.init();
                addStatus('‚úÖ i18n initialized', 'success');

                // Check if translations applied
                const testElement = document.querySelector('[data-i18n="nav.exchange"]');
                addStatus(`Test element text: "${testElement.textContent}"`, 'info');
            } catch (error) {
                addStatus(`‚ùå Error during init: ${error.message}`, 'error');
            }

            // Add change listener
            select.addEventListener('change', async (e) => {
                const lang = e.target.value;
                addStatus(`Switching to: ${lang}`, 'info');

                try {
                    await window.I18N.set(lang);
                    addStatus(`‚úÖ Switched to ${lang}`, 'success');

                    const testElement = document.querySelector('[data-i18n="nav.exchange"]');
                    addStatus(`After switch: "${testElement.textContent}"`, 'info');
                } catch (error) {
                    addStatus(`‚ùå Error switching language: ${error.message}`, 'error');
                }
            });
        }

        document.addEventListener('DOMContentLoaded', initTest);
    </script>
</body>
</html>
